<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="Case study: Computing 130,000+ pairwise station distances to challenge a 2-year policy assumption â€” proving distance-breaking DSPs outperform, then automating the fix into production SQL.">
    <title>Pinnacle Station Distance Analysis | Taylor Stephens</title>
    <link rel="icon" href="../../favicon.svg" type="image/svg+xml">
    <meta property="og:title" content="Pinnacle Station Distance Analysis | Taylor Stephens">
    <meta property="og:description" content="130K+ distance calculations proved a 2-year assumption wrong. Distance-breaking DSPs outperformed. Analysis drove the first policy change since program launch.">
    <meta property="og:type" content="article">
    <link rel="canonical" href="https://taylorstephens.dev/work/pinnacle-station/">
    <meta name="theme-color" content="#2563eb">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&family=Lora:wght@400;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="../../css/styles.css">
    <link rel="stylesheet" href="../../css/case-study.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.7/dist/chart.umd.min.js" defer></script>
    <script src="../../js/progress-bar.js" defer></script>
</head>
<body>

    <div class="reading-progress"></div>
    <a class="skip-link" href="#main-content">Skip to content</a>

    <nav class="back-nav" aria-label="Back navigation">
        <a href="../../index.html#projects">&larr; Back to Portfolio</a>
    </nav>

    <main id="main-content" class="case-study">

        <header class="cs-header">
            <h1>A 2-Year-Old Rule Was Costing 55% of Pinnacle Launches &mdash; The Data Proved It</h1>
            <p class="cs-tagline">I computed 130,000+ pairwise station distances to challenge a policy assumption no one had questioned since launch &mdash; then the data showed the DSPs who broke the rule actually outperformed everyone else. The analysis drove the first structural eligibility change in two years.</p>
            <div class="tech-pills">
                <span class="tech-pill">Geospatial Analysis (R)</span>
                <span class="tech-pill">Policy Design</span>
                <span class="tech-pill">SQL / Redshift</span>
                <span class="tech-pill">Scenario Modeling</span>
            </div>
        </header>

        <div class="scope-callout">
            <div class="scope-item">
                <span class="scope-label">Timeline</span>
                <span class="scope-value">Q3&ndash;Q4 2024</span>
            </div>
            <div class="scope-item">
                <span class="scope-label">My Role</span>
                <span class="scope-value">Senior PM, DSP Acquisitions</span>
            </div>
            <div class="scope-item">
                <span class="scope-label">Scale</span>
                <span class="scope-value">~362 stations, 130K+ pairs, 222 eligible DSPs</span>
            </div>
            <div class="scope-item">
                <span class="scope-label">Deliverables</span>
                <span class="scope-value">R analysis suite, Strategy proposal, 6-step SQL pipeline</span>
            </div>
        </div>

        <section class="cs-section" id="problem">
            <h2>Pinnacle Was Breaking Its Own Rules</h2>

            <p>Amazon&rsquo;s Pinnacle program is the expansion pathway for top-performing Delivery Service Partners &mdash; a DSP who has proven they can run one operation gets the opportunity to run a second. It&rsquo;s one of the highest-stakes decisions in the network: each launch requires a new station, new fleet, new drivers, and new routes. Getting the selection wrong wastes the opportunity; leaving it unfilled wastes the capacity.</p>

            <p>Since the program launched in May 2022, a single rule had governed eligibility: candidates must operate within 50 air miles of their target station. No one had data to question it. But by mid-2024, the program was in crisis. Launches had dropped 55% &mdash; from 93 in 2023 to just 42 &mdash; and 20 eligible candidates were bypassed in favor of less-qualified RTO (Recruit to Offer) candidates, directly violating the program&rsquo;s own 5-lever prioritization hierarchy.</p>

            <div class="metrics-row">
                <div class="metric-card">
                    <span class="metric-number">55%</span>
                    <span class="metric-label">Launch Decline</span>
                    <span class="metric-subtitle">93 &rarr; 42 year-over-year</span>
                </div>
                <div class="metric-card">
                    <span class="metric-number">20</span>
                    <span class="metric-label">Candidates Bypassed</span>
                    <span class="metric-subtitle">Eligible DSPs skipped for RTOs</span>
                </div>
                <div class="metric-card">
                    <span class="metric-number">47%</span>
                    <span class="metric-label">Outreach Coverage</span>
                    <span class="metric-subtitle">205 eligible, only 97 reached</span>
                </div>
                <div class="metric-card">
                    <span class="metric-number">8</span>
                    <span class="metric-label">Root Causes</span>
                    <span class="metric-subtitle">Data (4), Process (3), Tooling (1)</span>
                </div>
            </div>

            <p>The root cause diagnosis surfaced 8 distinct failure modes across three dimensions. The eligibility tracker ran on a 55+ MB Excel file with INDEX-MATCH calculations across 24,000 rows that regularly crashed. The &ldquo;Who&rsquo;s My Neighbor&rdquo; dashboard computed commute distances that fluctuated with traffic patterns &mdash; Station A to Station B could be 49 miles one month and 52 the next, creating inconsistent eligibility determinations. Data refreshed quarterly while performance updated monthly, missing DSPs who became eligible between snapshots. Double-counting inflated WBR numbers. And ~33% of the Pinnacle-eligible population &mdash; DSPs operating from island sites in Hawaii and Alaska and overstaffed markets &mdash; were structurally excluded by geography, not performance.</p>

            <div class="insight-callout">
                This wasn&rsquo;t a recruiting problem &mdash; it was a measurement problem. The process was failing across 8 dimensions simultaneously, meaning fixing any single one wouldn&rsquo;t solve the systemic failure. The 50-mile cap was the most visible symptom, but it was only one of eight.
            </div>
        </section>

        <section class="cs-section" id="approach">
            <h2>130,000 Distance Calculations and a Counter-Intuitive Finding</h2>

            <p>I approached this in three phases: research the problem with data, change the policy with evidence, then automate the solution into production. The entire arc &mdash; from R analysis to approved strategy proposal to SQL pipeline &mdash; took one quarter.</p>

            <h3>Phase 1: Geospatial Distance Analysis</h3>
            <p>The first question was simple: what exactly does the 50-mile cap exclude? To answer it, I computed pairwise geodesic distances across all ~362 US stations using R&rsquo;s <code>distVincentyEllipsoid</code> function from the <code>geosphere</code> package &mdash; the most accurate distance formula for an oblate spheroid, generating ~130,000 unique station pairs. Then I ran a distance interval sweep across 16 thresholds (50&ndash;200 miles in 10-mile increments), computing cumulative station coverage at each tier.</p>

            <p>The results quantified what no one had measured. At the 50-mile threshold, only 63.9% of US stations had at least 5 Pinnacle-eligible DSPs nearby. Expanding to 100 miles raised that to 85.4%. At 200 miles, it reached 96.0%. The 50-mile cap wasn&rsquo;t just conservative &mdash; it was systematically excluding over a third of the network from adequate candidate pools.</p>

            <div class="chart-container">
                <div class="chart-label">Station Coverage by Distance Threshold (AtLeast5 Neighbors)</div>
                <canvas id="coverageChart" aria-label="Line chart showing station coverage increasing from 63.9% at 50 miles to 96.0% at 200 miles, with steepest gain between 50 and 100 miles"></canvas>
            </div>

            <table class="data-table">
                <caption>Coverage matrix: percentage of stations with N+ eligible DSPs within distance</caption>
                <thead>
                    <tr>
                        <th>Distance</th>
                        <th>AtLeast1</th>
                        <th>AtLeast3</th>
                        <th>AtLeast5</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>50 mi</td>
                        <td>90.3%</td>
                        <td>78.1%</td>
                        <td>63.9%</td>
                    </tr>
                    <tr>
                        <td>60 mi</td>
                        <td>91.8%</td>
                        <td>80.6%</td>
                        <td>66.7%</td>
                    </tr>
                    <tr>
                        <td>80 mi</td>
                        <td>95.1%</td>
                        <td>86.9%</td>
                        <td>75.7%</td>
                    </tr>
                    <tr>
                        <td>100 mi</td>
                        <td>97.5%</td>
                        <td>90.9%</td>
                        <td>85.4%</td>
                    </tr>
                    <tr>
                        <td>150 mi</td>
                        <td>99.0%</td>
                        <td>97.5%</td>
                        <td>91.8%</td>
                    </tr>
                    <tr>
                        <td>200 mi</td>
                        <td>99.4%</td>
                        <td>98.5%</td>
                        <td class="highlight">96.0%</td>
                    </tr>
                </tbody>
            </table>

            <h3>The Counter-Intuitive Finding</h3>
            <p>The coverage data made the case for expansion. But leadership needed a different kind of proof: that farther DSPs could actually perform. The assumption behind the 50-mile cap &mdash; that distance correlates with degraded performance &mdash; had been accepted without evidence for over two years.</p>

            <p>I analyzed the 17 DSPs who had been launched despite known distance criteria breaks since 2023. The results dismantled the assumption entirely: distance-breaking DSPs outperformed non-breakers across every metric.</p>

            <table class="data-table">
                <caption>Performance: distance-breaking DSPs (n=17) vs. non-breakers (n=91)</caption>
                <thead>
                    <tr>
                        <th>Metric</th>
                        <th>Distance Breakers</th>
                        <th>Non-Breakers</th>
                        <th>Difference</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>CSAT</td>
                        <td class="highlight">82%</td>
                        <td>74%</td>
                        <td class="highlight">+800 bps</td>
                    </tr>
                    <tr>
                        <td>DSP Quality</td>
                        <td class="highlight">100%</td>
                        <td>90%</td>
                        <td class="highlight">+10 pp</td>
                    </tr>
                    <tr>
                        <td>CR (T12M)</td>
                        <td class="highlight">109.6%</td>
                        <td>106.6%</td>
                        <td class="highlight">+3.0 pts</td>
                    </tr>
                    <tr>
                        <td>Tier 1 Post-Launch</td>
                        <td class="highlight">51%</td>
                        <td>43%</td>
                        <td class="highlight">+8 pp</td>
                    </tr>
                    <tr>
                        <td>SLS Safety</td>
                        <td class="highlight">100% Fantastic</td>
                        <td>97% Fantastic</td>
                        <td class="highlight">+3 pp</td>
                    </tr>
                    <tr>
                        <td>NSF Breaches</td>
                        <td class="highlight">0</td>
                        <td>2</td>
                        <td class="highlight">&minus;2</td>
                    </tr>
                </tbody>
            </table>

            <p>Of the 17 distance breakers, 71% came from island sites (5 DSPs) or overstaffed markets (7 DSPs) &mdash; situations where the geographic constraint was a structural disadvantage, not a performance predictor. This wasn&rsquo;t a handful of lucky exceptions. It was a systematic pattern proving the assumption wrong.</p>

            <h3>Phase 2: Policy Change</h3>
            <p>I formatted the analysis outputs &mdash; Table 2 coverage matrix, burndown projections, distance-vs-performance comparisons &mdash; for direct inclusion in the October 2024 leadership strategy proposal. The data created the permission structure for what arguments alone could not: the first structural change to Pinnacle eligibility since the program launched in May 2022.</p>

            <p>The approved 3-tier prioritization:</p>
            <ul>
                <li><strong>Tier 1 &mdash; Pop-Up DSPs (new):</strong> When a target opens, award it to a Pinnacle-eligible DSP already doing a pop-up at that station, regardless of distance. They&rsquo;ve already proven execution at the location.</li>
                <li><strong>Tier 2 &mdash; &le;50 Air Miles (maintained):</strong> Continue prioritizing proximity. Tiebreakers: duration of eligibility &gt; highest NH score &gt; highest T6M CR ratio.</li>
                <li><strong>Tier 3 &mdash; 5-Closest Stations (new, up to ~250 miles):</strong> If fewer than 5 candidates exist within 50 miles, expand to the 5 closest stations. This tier alone raised coverage from 63.9% to 96.0%.</li>
            </ul>
        </section>

        <section class="cs-section" id="technical">
            <h2>From R Research to SQL Production</h2>

            <p>The R analysis proved the policy needed changing. The SQL pipeline made it operational. The 6-step query architecture on Amazon Redshift directly encodes the policy decisions derived from the distance analysis &mdash; replacing the 55+ MB crash-prone Excel file with stable, scalable, auditable infrastructure.</p>

            <h3>6-Step SQL Pipeline</h3>
            <div class="process-timeline">
                <div class="timeline-item completed">
                    <div class="timeline-week">Step 1</div>
                    <div class="timeline-title">nh_score_config &mdash; Quarterly Snapshot Configuration</div>
                    <div class="timeline-desc">Config table with 9 quarterly snapshot dates (2022Q1&ndash;2024Q3). Solves the quarterly lag problem by defining which NH snapshots to use, enabling monthly integration.</div>
                </div>
                <div class="timeline-item completed">
                    <div class="timeline-week">Step 2</div>
                    <div class="timeline-title">static_tier &mdash; Two-Period Tier Validation</div>
                    <div class="timeline-desc"><code>LAG(adjusted_tier, 1) OVER (PARTITION BY dsp ORDER BY snapshot_date)</code> validates that DSPs maintained Tier 1 across consecutive quarters. Prevents one-quarter flukes from qualifying DSPs.</div>
                </div>
                <div class="timeline-item completed">
                    <div class="timeline-week">Step 3</div>
                    <div class="timeline-title">pinnacle_eligible_1 &mdash; NH Scores + MSO Vetting</div>
                    <div class="timeline-desc">Joins tier-validated DSPs with current NH scores, station transfer history, and MSO vetting history. Includes a 30+ DSP exclusion list. Solves the vetting gaps and double-counting problems.</div>
                </div>
                <div class="timeline-item completed">
                    <div class="timeline-week">Step 4</div>
                    <div class="timeline-title">temp_station_data &mdash; Station Coordinates</div>
                    <div class="timeline-desc">Maps all stations to lat/long coordinates for the distance calculation. Sourced from station master table, filtered for non-null coordinates.</div>
                </div>
                <div class="timeline-item completed">
                    <div class="timeline-week">Step 5</div>
                    <div class="timeline-title">station_pairs &mdash; Haversine Distance (CROSS JOIN)</div>
                    <div class="timeline-desc"><code>3959 * ACOS(COS(RAD(lat_a)) * COS(RAD(lat_b)) * COS(RAD(lon_b) - RAD(lon_a)) + SIN(RAD(lat_a)) * SIN(RAD(lat_b)))</code> via CROSS JOIN across all station pairs. Earth radius constant (3,959 mi) provides consistent straight-line distance.</div>
                </div>
                <div class="timeline-item completed">
                    <div class="timeline-week">Step 6</div>
                    <div class="timeline-title">Final Selection &mdash; 3-Tier Prioritization Encoded</div>
                    <div class="timeline-desc"><code>WHERE distance &le; 50 OR (distance &le; 250 AND rank &le; 5 AND NOT EXISTS (... WHERE distance &le; 50))</code> &mdash; the approved policy encoded directly in SQL. <code>ROW_NUMBER()</code> produces the prioritized outreach list per station.</div>
                </div>
            </div>

            <h3>R &rarr; SQL Methodology Bridge</h3>
            <p>The R pipeline used Vincenty Ellipsoid distance &mdash; the most accurate formula for an oblate spheroid. The SQL pipeline uses Haversine &mdash; sufficient accuracy for 50&ndash;250 mile distances (&lt;0.3% difference) and native to Redshift math functions with no external dependencies. Same math, different execution environments.</p>

            <table class="data-table">
                <caption>How R analysis translated to SQL production</caption>
                <thead>
                    <tr>
                        <th>R (Research)</th>
                        <th>SQL (Production)</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>distVincentyEllipsoid (Vincenty Ellipsoid)</td>
                        <td class="highlight">3959 * ACOS(...) (Haversine)</td>
                    </tr>
                    <tr>
                        <td>expand.grid() &mdash; all station pairs</td>
                        <td class="highlight">CROSS JOIN &mdash; same combinatorial logic</td>
                    </tr>
                    <tr>
                        <td>row_number() by distance (top-5)</td>
                        <td class="highlight">ROW_NUMBER() OVER (PARTITION BY ... ORDER BY ...)</td>
                    </tr>
                    <tr>
                        <td>16-threshold interval sweep</td>
                        <td class="highlight">WHERE &le;50 OR (NOT EXISTS ... &le;250)</td>
                    </tr>
                    <tr>
                        <td>Separate script per scenario</td>
                        <td class="highlight">Single 6-step integrated query</td>
                    </tr>
                </tbody>
            </table>
        </section>

        <section class="cs-section" id="results">
            <h2>94.1% Fill Rate &mdash; and the First Policy Change in Two Years</h2>

            <div class="metrics-row">
                <div class="metric-card">
                    <span class="metric-number">94.1%</span>
                    <span class="metric-label">Fill Rate</span>
                    <span class="metric-subtitle">+36 pp over 57.9% baseline</span>
                </div>
                <div class="metric-card">
                    <span class="metric-number">100%</span>
                    <span class="metric-label">July Fill Rate</span>
                    <span class="metric-subtitle">8 targets closed (+35 pp YTD)</span>
                </div>
                <div class="metric-card">
                    <span class="metric-number">96.0%</span>
                    <span class="metric-label">Station Coverage</span>
                    <span class="metric-subtitle">Up from 63.9% (+32.1 pp)</span>
                </div>
                <div class="metric-card">
                    <span class="metric-number">1 &rarr; 5</span>
                    <span class="metric-label">BDM Team</span>
                    <span class="metric-subtitle">5&times; outreach capacity</span>
                </div>
            </div>

            <div class="chart-container">
                <div class="chart-label">Pinnacle Fill Rate Recovery</div>
                <canvas id="fillRateChart" aria-label="Bar chart showing fill rate: 57.9% baseline, 94.1% post-fix, 100% in July 2024"></canvas>
            </div>

            <p>The combined effect of the distance analysis, policy change, and SQL automation produced measurable program recovery. Fill rate jumped from 57.9% to 94.1% (+36 percentage points), with July 2024 hitting 100% across 8 targets &mdash; 1 MMRO, 1 XL, and 7 ZL. The automation script was marked &ldquo;completed&rdquo; in leadership results documentation (Taylor Stephens, ECD: completed).</p>

            <p>The 3-tier prioritization &mdash; approved in October 2024 &mdash; was the first structural change to Pinnacle eligibility since the program launched in May 2022. Previously, distance exceptions required individual escalation and approval (17 exceptions since 2023, 71% from island or overstaffed sites). Now, the 5-closest-stations fallback is systematic and encoded in the production SQL pipeline.</p>

            <table class="data-table">
                <caption>System transformation: before and after</caption>
                <thead>
                    <tr>
                        <th>Before</th>
                        <th>After</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>55+ MB Excel file (crashes regularly)</td>
                        <td class="highlight">6-step SQL pipeline on Amazon Redshift</td>
                    </tr>
                    <tr>
                        <td>Traffic-dependent commute distances</td>
                        <td class="highlight">Haversine straight-line (constant, reproducible)</td>
                    </tr>
                    <tr>
                        <td>Quarterly data refresh</td>
                        <td class="highlight">Monthly NH integration (3&times; faster)</td>
                    </tr>
                    <tr>
                        <td>Double-counting in WBR reports</td>
                        <td class="highlight">Exclusion logic for existing Pinnacle DSPs</td>
                    </tr>
                    <tr>
                        <td>Ad hoc distance exception escalation</td>
                        <td class="highlight">Systematic 3-tier policy (no case-by-case approval)</td>
                    </tr>
                    <tr>
                        <td>20 candidates bypassed to RTO</td>
                        <td class="highlight">0 candidates missed (automated identification)</td>
                    </tr>
                    <tr>
                        <td>47% outreach coverage</td>
                        <td class="highlight">Projected 60&ndash;69% under new criteria</td>
                    </tr>
                    <tr>
                        <td>1 BDM team member</td>
                        <td class="highlight">5 BDM members (5&times; capacity)</td>
                    </tr>
                    <tr>
                        <td>57.9% fill rate (42 launches)</td>
                        <td class="highlight">94.1% fill rate (100% in July)</td>
                    </tr>
                </tbody>
            </table>

            <p>The infrastructure legacy extends beyond the immediate fix. The distance matrix is reusable for any future threshold analysis &mdash; run with updated station coordinates, get updated coverage tables. The coverage table format (Table 2) was adopted as a standard WBR reporting artifact. And the analysis approach &mdash; interval sweep plus counter-intuitive performance comparison &mdash; was cited as a model for future eligibility criteria reviews across DSP programs.</p>
        </section>

        <section class="cs-section" id="lessons">
            <h2>What This Taught Me</h2>
            <ul class="lessons-list">
                <li>Challenge sacred assumptions with data, not arguments. The 50-mile cap survived 2+ years because no one had quantified what it excluded. 130,000 distance calculations and a performance comparison did what qualitative feedback couldn&rsquo;t.</li>
                <li>Counter-intuitive findings are permission structures. Leadership didn&rsquo;t need more opinions &mdash; they needed statistical proof that distance-breaking DSPs outperform. The data created the political space to approve the change.</li>
                <li>Research &rarr; Policy &rarr; Automation is the complete arc. Analysis that doesn&rsquo;t change policy is academic. Policy that isn&rsquo;t automated is aspirational. The value came from carrying findings through all three phases in one quarter.</li>
                <li>Geographic equity is an efficiency argument. Framing the 50-mile cap as geographic exclusion &mdash; rural stations, island sites, 33% of eligible DSPs &mdash; broadened the case beyond program metrics to network fairness, which resonated with leadership in a way pure performance data didn&rsquo;t.</li>
            </ul>
        </section>

        <section class="cs-cta">
            <p>Next: <a href="../charge-back-processing/chargeback-parsing.html">Chargeback Email Parsing Automation</a></p>
        </section>

    </main>

    <footer>
        <p>&copy; 2026 Taylor Stephens. All rights reserved.</p>
    </footer>

    <script>
    document.addEventListener('DOMContentLoaded', function() {
        var accent = '#2563eb';
        var green = '#16a34a';
        var red = '#dc3545';
        var muted = 'rgba(107, 107, 107, 0.3)';
        var defaults = {
            responsive: true,
            maintainAspectRatio: true,
            animation: { duration: 1200, easing: 'easeOutQuart' },
            plugins: {
                legend: { display: false },
                tooltip: {
                    backgroundColor: '#1a1a1a',
                    titleFont: { family: "'Inter', sans-serif", size: 12 },
                    bodyFont: { family: "'Inter', sans-serif", size: 12 },
                    padding: 10,
                    cornerRadius: 4
                }
            }
        };

        // Coverage curve - line chart (AtLeast5 neighbors by distance)
        new Chart(document.getElementById('coverageChart'), {
            type: 'line',
            data: {
                labels: ['50 mi', '60 mi', '80 mi', '100 mi', '150 mi', '200 mi'],
                datasets: [{
                    data: [63.9, 66.7, 75.7, 85.4, 91.8, 96.0],
                    borderColor: accent,
                    backgroundColor: 'rgba(37, 99, 235, 0.08)',
                    fill: true,
                    tension: 0.3,
                    pointRadius: 5,
                    pointBackgroundColor: [red, accent, accent, accent, accent, green],
                    pointBorderColor: '#fff',
                    pointBorderWidth: 2,
                    pointHoverRadius: 7,
                    borderWidth: 2.5
                }]
            },
            options: Object.assign({}, defaults, {
                aspectRatio: 2.5,
                scales: {
                    y: {
                        min: 55,
                        max: 100,
                        grid: { color: 'rgba(0,0,0,0.04)' },
                        ticks: {
                            font: { family: "'Inter', sans-serif", size: 11 },
                            color: '#6b6b6b',
                            callback: function(v) { return v + '%'; }
                        }
                    },
                    x: {
                        grid: { display: false },
                        ticks: {
                            font: { family: "'Inter', sans-serif", size: 11, weight: 600 },
                            color: '#3d3d3d'
                        }
                    }
                },
                plugins: {
                    legend: { display: false },
                    tooltip: {
                        backgroundColor: '#1a1a1a',
                        titleFont: { family: "'Inter', sans-serif", size: 12 },
                        bodyFont: { family: "'Inter', sans-serif", size: 12 },
                        padding: 10,
                        cornerRadius: 4,
                        callbacks: {
                            label: function(ctx) {
                                return ctx.parsed.y + '% of stations with 5+ eligible DSPs';
                            }
                        }
                    }
                }
            })
        });

        // Fill rate bar chart
        new Chart(document.getElementById('fillRateChart'), {
            type: 'bar',
            data: {
                labels: ['Baseline', 'Post-Fix', 'July 2024'],
                datasets: [{
                    data: [57.9, 94.1, 100],
                    backgroundColor: [muted, green, accent],
                    borderRadius: 4,
                    barThickness: 50
                }]
            },
            options: Object.assign({}, defaults, {
                aspectRatio: 2.5,
                scales: {
                    y: {
                        beginAtZero: true,
                        max: 110,
                        grid: { color: 'rgba(0,0,0,0.04)' },
                        ticks: {
                            font: { family: "'Inter', sans-serif", size: 11 },
                            color: '#6b6b6b',
                            callback: function(v) { return v + '%'; }
                        }
                    },
                    x: {
                        grid: { display: false },
                        ticks: {
                            font: { family: "'Inter', sans-serif", size: 11, weight: 600 },
                            color: '#3d3d3d'
                        }
                    }
                }
            })
        });
    });
    </script>

</body>
</html>
