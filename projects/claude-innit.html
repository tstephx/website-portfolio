<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="Case study: Building persistent memory for Claude across sessions using MCP, SQLite FTS5, and semantic embeddings.">
    <title>Claude-Innit | Taylor Stephens</title>
    <link rel="icon" href="../favicon.svg" type="image/svg+xml">
    <meta property="og:title" content="Claude-Innit | Taylor Stephens">
    <meta property="og:description" content="Gave Claude persistent memory across sessions with personal, project, and session context that survives conversation boundaries.">
    <meta property="og:type" content="article">
    <link rel="canonical" href="https://taylorstephens.io/projects/claude-innit">
    <meta name="theme-color" content="#2563eb">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&family=Lora:wght@400;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="../css/styles.css">
    <link rel="stylesheet" href="../css/case-study.css">
    <script src="../js/progress-bar.js" defer></script>
</head>
<body>

    <div class="reading-progress"></div>
    <a class="skip-link" href="#main-content">Skip to content</a>

    <nav class="back-nav" aria-label="Back navigation">
        <a href="../index.html#personal-projects">&larr; Back to Portfolio</a>
    </nav>

    <main id="main-content" class="case-study">

        <header class="cs-header">
            <h1>Giving Claude a Memory: Building Persistent Context with MCP</h1>
            <p class="cs-tagline">Persistent memory across sessions &mdash; personal identity, project context, and session continuity that survives conversation boundaries.</p>
            <div class="tech-pills">
                <span class="tech-pill">Python</span>
                <span class="tech-pill">MCP Server</span>
                <span class="tech-pill">SQLite</span>
                <span class="tech-pill">FTS5</span>
                <span class="tech-pill">Sentence-Transformers</span>
                <span class="tech-pill">Markdown</span>
            </div>
        </header>

        <section class="cs-section" id="problem">
            <h2>The Problem</h2>
            <p>Claude forgets everything between sessions. Every new conversation starts from scratch &mdash; no memory of preferences, project decisions, or previous work. The result: constant re-explanation, lost context, and duplicated effort.</p>
            <p>The internal frustration was real: I&rsquo;d have a productive session making architectural decisions, and the next day Claude would ask the same questions as if we&rsquo;d never spoken. The philosophical issue was simple &mdash; an AI assistant should remember what matters to you.</p>
        </section>

        <section class="cs-section" id="approach">
            <h2>The Approach</h2>
            <p>I built a memory system with three categories, dual search, and a markdown-first storage philosophy &mdash; all exposed as an MCP server with 7 tools that Claude Code can call natively.</p>

            <div class="mermaid-container" role="img" aria-label="Data flow: Markdown files to Claude Code via SQLite and MCP server">
                <div class="mermaid">
flowchart LR
    MD["Markdown Files\n(Source of Truth)"] --> SYNC["Sync Engine"]
    SYNC --> DB["SQLite DB"]
    DB --> FTS["FTS5 Index"]
    DB --> EMB["384-dim Embeddings"]
    FTS --> MCP["MCP Server\n7 Tools"]
    EMB --> MCP
    MCP --> CC["Claude Code"]
                </div>
            </div>

            <h3>Three-Step Plan</h3>
            <ul>
                <li><strong>Design memory categories:</strong> Personal (identity, preferences), Project (per-repo context and decisions), and Session (conversation summaries with timestamps).</li>
                <li><strong>Build dual-search retrieval:</strong> Smart routing &mdash; short queries (1&ndash;3 words) go to FTS5 for keyword matching, longer queries go to semantic search for conceptual similarity.</li>
                <li><strong>Integrate as MCP server:</strong> 7 tools (<code>get_context</code>, <code>search</code>, <code>remember</code>, <code>forget</code>, <code>save_session</code>, <code>sync</code>, <code>check_integrity</code>) registered with Claude Code.</li>
            </ul>
        </section>

        <section class="cs-section" id="technical">
            <h2>Key Technical Decisions</h2>

            <h3>Three Memory Categories</h3>
            <p>Memories are organized into three tiers: <strong>personal</strong> (static profile &mdash; identity, preferences, workflows), <strong>project</strong> (scoped to a specific repo &mdash; decisions, architecture, recent work), and <strong>session</strong> (temporal markers &mdash; conversation summaries with topics and dates).</p>

            <table class="data-table">
                <caption>Memory categories: scope, examples, and persistence</caption>
                <thead>
                    <tr>
                        <th>Category</th>
                        <th>Scope</th>
                        <th>Examples</th>
                        <th>Persistence</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td class="highlight">Personal</td>
                        <td>Global</td>
                        <td>Identity, preferences, coding style</td>
                        <td>Permanent</td>
                    </tr>
                    <tr>
                        <td class="highlight">Project</td>
                        <td>Per-repo</td>
                        <td>Decisions, architecture, tech stack</td>
                        <td>Permanent</td>
                    </tr>
                    <tr>
                        <td class="highlight">Session</td>
                        <td>Temporal</td>
                        <td>Summaries, topics, timestamps</td>
                        <td>Rolling window</td>
                    </tr>
                </tbody>
            </table>

            <h3>Smart Search Routing</h3>
            <div class="mermaid-container" role="img" aria-label="Search routing: short queries to FTS5, long queries to semantic search">
                <div class="mermaid">
flowchart TD
    Q["Search Query"] --> WC{"Word Count"}
    WC -->|"1-3 words"| FTS["FTS5 Search\n(Fast keyword match)"]
    WC -->|"4+ words"| SEM["Semantic Search\n(Conceptual similarity)"]
    FTS --> R["Ranked Results"]
    SEM --> R
                </div>
            </div>
            <p>Word count is a low-cost heuristic that avoids ML overhead for simple lookups. Short queries like &ldquo;Python preferences&rdquo; hit FTS5 directly. Longer queries like &ldquo;what architecture decisions did we make for the API&rdquo; route to semantic search for intent matching.</p>

            <h3>Markdown-First Storage</h3>
            <p>Markdown files are the source of truth; the database is just an index. YAML frontmatter stores metadata, plain text stays human-readable, and bidirectional sync keeps everything consistent. This means memories are git-friendly, diffable, and readable without any code.</p>

            <pre><code># data/memories/personal/identity.md
---
type: identity
---

My name is Taylor Stephens
Role: Program Manager with MBA background
Preference: Research-first workflow, book library before web</code></pre>

            <h3>Session Lifecycle</h3>
            <div class="mermaid-container" role="img" aria-label="Session lifecycle: start, accumulate, save, and load in next session">
                <div class="mermaid">
flowchart LR
    S["Session Start\nget_context()"] --> A["Accumulate\nremember(), search()"]
    A --> E["Session End\nsave_session()"]
    E --> N["Next Session\nget_context() loads\nrecent summaries"]
                </div>
            </div>

            <h3>TDD Implementation</h3>
            <p>Every feature was test-driven: write failing test, implement minimal code, commit. The 19 tests across 5 modules cover all critical paths &mdash; database operations, embedding generation, markdown sync, search routing, and MCP tool registration.</p>
        </section>

        <section class="cs-section" id="results">
            <h2>Results</h2>

            <div class="metrics-row">
                <div class="metric-card">
                    <span class="metric-number">3</span>
                    <span class="metric-label">Memory Categories</span>
                </div>
                <div class="metric-card">
                    <span class="metric-number">7</span>
                    <span class="metric-label">MCP Tools</span>
                </div>
                <div class="metric-card">
                    <span class="metric-number">19</span>
                    <span class="metric-label">Tests (TDD)</span>
                </div>
                <div class="metric-card">
                    <span class="metric-number">743</span>
                    <span class="metric-label">Lines of Core Code</span>
                </div>
            </div>

            <p>Claude now loads my preferences, project context, and recent session summaries at the start of every conversation. No more re-explaining workflows, architecture decisions, or coding style. The markdown-first approach means I can also edit memories directly in a text editor &mdash; no database tools required.</p>
        </section>

        <section class="cs-section" id="lessons">
            <h2>Lessons Learned</h2>
            <ul class="lessons-list">
                <li>TDD discipline paid off &mdash; 19 tests caught real bugs during implementation, especially in the sync engine where frontmatter parsing edge cases were non-obvious.</li>
                <li>Markdown files as source of truth keeps data human-inspectable and git-friendly. The database is disposable &mdash; rebuild it anytime from the markdown.</li>
                <li>Lazy-loading the embedding model avoids a 5-second startup penalty when only keyword search is needed.</li>
                <!-- Placeholder for Taylor's personal reflection -->
            </ul>
        </section>

        <section class="cs-cta">
            <a href="#" class="cta-button">View on GitHub</a>
            <p>Back to: <a href="mcp-ecosystem.html">MCP Ecosystem Overview</a> | Next: <a href="tap-sevenrooms.html">tap-sevenrooms</a></p>
        </section>

    </main>

    <footer>
        <p>&copy; 2026 Taylor Stephens. All rights reserved.</p>
    </footer>

    <script src="https://cdn.jsdelivr.net/npm/mermaid@11/dist/mermaid.min.js"></script>
    <script src="../js/mermaid-init.js"></script>

</body>
</html>
